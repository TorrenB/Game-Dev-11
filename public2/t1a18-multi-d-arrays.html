<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Array and Spinning Cube</title>
    <style>
        body {
            background-color: #1a1a1a; /* Dark background */
            color: #f5f5f5; /* Light text color */
            font-family: Arial, sans-serif;
            margin: 20px;
            overflow: auto; /* Allow scrolling */
            max-height: 100vh; /* Limit height to viewport */
        }
        h1, h2 {
            color: #ffd700; /* Yellow color for headings */
        }
        textarea, input {
            width: 100%;
            padding: 10px;
            border: 1px solid #555; /* Light gray border */
            border-radius: 5px;
            background-color: #2b2b2b; /* Darker background for inputs */
            color: #f5f5f5; /* Light text */
        }
        textarea:focus, input:focus {
            outline: none;
            border-color: #ffd700; /* Yellow border on focus */
        }
        .button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #007acc; /* Dark blue for buttons */
            color: #f5f5f5; /* Light text on buttons */
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3); /* Drop shadow effect */
            transition: transform 0.1s, box-shadow 0.1s; /* Animations */
        }
        .button:hover {
            background-color: #005f99; /* Darker blue on hover */
        }
        .button:active {
            transform: translateY(2px); /* Push down effect */
            box-shadow: 0 1px 3px rgba(0,0,0,0.3); /* Adjust shadow on click */
        }
        pre {
            background-color: #333; /* Darker preformatted text background */
            padding: 10px;
            border-radius: 5px;
            color: #f5f5f5; /* Light text */
            overflow: auto; /* Allow scrolling */
        }
        #result {
            margin-top: 20px;
            background-color: #333; /* Darker background for results */
            padding: 10px;
            border-radius: 5px;
            color: #ffd700; /* Yellow color for results */
        }
        #canvas-container {
            width: 100%;
            height: 400px;
            margin-top: 20px; /* Create space before the canvas */
        }
    </style>
</head>
<body>

    <h1>3D Array and Number Selection</h1>

    <form id="arrayForm">
        <label for="arrayInput">Enter a 3D array (e.g., [[[1, 2], [3, 4]], [[5, 6], [7, 8]]]):</label><br>
        <textarea id="arrayInput" rows="4" placeholder="[[[1, 2, 3], [4, 5, 6]], [[7, 8, 9], [10, 11, 12]]]"></textarea><br><br>

        <label for="selector">Select an element with x[w,y,z] notation:</label><br>
        <input type="text" id="selector" placeholder="Enter w,y,z (e.g., 0,1,1)"><br><br>

        <label for="numbersInput">Enter numbers (up to 60, separated by commas):</label><br>
        <textarea id="numbersInput" rows="4" placeholder="E.g., 5, 10, 15, ..."></textarea><br><br>

        <button type="submit" class="button">Submit</button>
        <button type="button" class="button" id="loadPreset">Load Predefined Array</button>
        <button type="button" class="button" id="generateRandom">Generate Random 3D Array</button>
    </form>

    <h2>Viewing Layers:</h2>
    <button id="viewLayers" class="button">Show Next 6 Layers</button>
    <pre id="output"></pre>

    <h2>Results:</h2>
    <div id="result"></div>

    <h2>3D Visual Representation:</h2>
    <div id="canvas-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let multiDimArray;
        let layerIndex = 0;
        let maxLayersToShow = 6; // Maximum number of layers to show at once
        let currentLayers = []; // Store current layers to display
        let scene, camera, renderer;

        // Initialize Three.js
        function initThree() {
            const canvasContainer = document.getElementById('canvas-container');
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / 2 / 400, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth / 2, 400);
            canvasContainer.appendChild(renderer.domElement);
            camera.position.z = 5;
            animate();
        }

        // Animate the spinning cubes
        function animate() {
            requestAnimationFrame(animate);
            if (scene.children.length > 0) {
                scene.children.forEach(cube => {
                    cube.rotation.x += 0.01;
                    cube.rotation.y += 0.01;
                });
            }
            renderer.render(scene, camera);
        }

        function createCubes(data) {
            // Clear old cubes
            while (scene.children.length > 0) { 
                scene.remove(scene.children[0]); 
            }

            const size = 1; // Size of each cube
            const geometry = new THREE.BoxGeometry(size, size, size);

            // Iterate over the 3D array and create cubes
            for (let w = 0; w < data.length; w++) {
                for (let y = 0; y < data[w].length; y++) {
                    for (let z = 0; z < data[w][y].length; z++) {
                        const value = data[w][y][z] !== undefined ? data[w][y][z] : 0;
                        const color = new THREE.Color(`hsl(${(value % 360)}, 100%, 50%)`);
                        
                        const material = new THREE.MeshBasicMaterial({ color: color });
                        const cube = new THREE.Mesh(geometry, material);

                        // Position the cube in 3D space
                        cube.position.set(w - (data.length - 1) / 2, y - (data[w].length - 1) / 2, z - (data[w][y].length - 1) / 2);
                        scene.add(cube);
                    }
                }
            }
        }

        document.getElementById('arrayForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting

            const arrayInput = document.getElementById('arrayInput').value;
            
            try {
                // Parse the input to a multi-dimensional array
                multiDimArray = JSON.parse(arrayInput);
                
                // Validate whether the parsed input is a 3D array
                if (!Array.isArray(multiDimArray) || 
                    !multiDimArray.every(arr => Array.isArray(arr) && arr.every(inner => Array.isArray(inner)))) {
                    throw new Error("Input must be a 3D array");
                }

                // Reset layer index and display the first 6 layers
                layerIndex = 0;
                currentLayers = multiDimArray.slice(layerIndex, layerIndex + maxLayersToShow);
                displayLayers();
                createCubes(multiDimArray);

            } catch (error) {
                // Handle any JSON parsing errors or validation issues
                document.getElementById('output').textContent = "Error: " + error.message;
            }
        });

        document.getElementById('loadPreset').addEventListener('click', function() {
            // Load a predefined multi-dimensional array
            const predefinedArray = [
                [[1, 2, 3], [4, 5, 6]],
                [[7, 8, 9], [10, 11, 12]],
                [[13, 14, 15], [16, 17, 18]],
                [[19, 20, 21], [22, 23, 24]],
                [[25, 26, 27], [28, 29, 30]],
                [[31, 32, 33], [34, 35, 36]]
            ];
            document.getElementById('arrayInput').value = JSON.stringify(predefinedArray);
        });

        document.getElementById('generateRandom').addEventListener('click', function() {
            // Generate a random 3D array of given dimensions
            const depth = 6, rows = 3, cols = 4; // Dimensions for the 3D array
            const min = 1, max = 20; // Range for random values
            
            multiDimArray = Array.from({ length: depth }, () =>
                Array.from({ length: rows }, () =>
                    Array.from({ length: cols }, () =>
                        Math.floor(Math.random() * (max - min + 1)) + min
                    )
                )
            );

            // Display the generated array in the textarea
            document.getElementById('arrayInput').value = JSON.stringify(multiDimArray);
            
            // Reset layer index and display the first 6 layers
            layerIndex = 0;
            currentLayers = multiDimArray.slice(layerIndex, layerIndex + maxLayersToShow);
            displayLayers();
            createCubes(multiDimArray);
        });

        document.getElementById('viewLayers').addEventListener('click', function() {
            if (multiDimArray) {
                layerIndex += maxLayersToShow;
                if (layerIndex < multiDimArray.length) {
                    currentLayers = multiDimArray.slice(layerIndex, layerIndex + maxLayersToShow);
                    displayLayers();
                } else {
                    layerIndex = 0; // Loop back to the start
                    currentLayers = multiDimArray.slice(layerIndex, layerIndex + maxLayersToShow);
                    displayLayers();
                }
                createCubes(multiDimArray); // Update cubes with the current array
            }
        });

        function displayLayers() {
            const displayedLayers = currentLayers.map((layer, index) => `Layer ${layerIndex + index}:\n` + JSON.stringify(layer, null, 2)).join("\n\n");
            document.getElementById('output').textContent = displayedLayers;
        }

        document.getElementById('selector').addEventListener('input', function() {
            const input = this.value;
            const indices = input.split(',').map(Number);
            if (indices.length === 3) {
                const [w, y, z] = indices;
                if (multiDimArray && multiDimArray[w] && multiDimArray[w][y] && multiDimArray[w][y][z] !== undefined) {
                    const selectedValue = multiDimArray[w][y][z];
                    document.getElementById('result').textContent = `Selected Value (x[${w},${y},${z}]): ${selectedValue}`;
                } else {
                    document.getElementById('result').textContent = "Invalid indices. Please enter valid w,y,z.";
                }
            } else {
                document.getElementById('result').textContent = "";
            }
        });

        document.getElementById('numbersInput').addEventListener('input', function() {
            const numbersInput = this.value;
            const numbersArray = numbersInput.split(',')
                .map(num => parseFloat(num.trim()))
                .filter(num => !isNaN(num));

            if (numbersArray.length > 60) {
                document.getElementById('result').textContent = "You can only enter up to 60 numbers.";
            } else {
                const sum = numbersArray.reduce((acc, val) => acc + val, 0);
                document.getElementById('result').textContent += `\nSum of entered numbers: ${sum}`;
            }
        });

        // Initialize the 3D scene
        initThree();
    </script>
</body>
</html>
